# Copyright 2019 Thomas Brown
# Distributed under the Boost Software License, Version 1.0. (See
# accompanying file LICENSE_1_0.txt or copy at
# http://www.boost.org/LICENSE_1_0.txt)

project
  : default-build
    <target-os>elf
    <target-os>freertos

    <architecture>
    <architecture>arm

    <instruction-set>cortex-a53
    <instruction-set>cortex-r5+vfpv3-d16

    <floating-point-abi>hard
    <floating-point-abi>softfp
    <floating-point-abi>soft
  : requirements
    <link>static
  ;

# @todo add more configurations for freertos
explicit ws ;
xsdkws ws
  : # sources
    $(zcu102-hdf)
  : # requirements
    <target-os>elf:<xsdk-template>"Hello World"
    <target-os>freertos:<xsdk-template>"FreeRTOS Hello World"
  : # default-build
  : # usage-requirements
    <linkflags>"-Wl,-T -Wl,lscript.ld"
  ;

exe hello
  : # sources
    helloworld.c
    platform.c
    platform_config.h
    platform.h

    ws
  : # requirements
    <dependency>ws

    # @todo required since Xilinx SDK has a bug
    <instruction-set>cortex-r5+vfpv3-d16:<floating-point-abi>softfp
  ;
